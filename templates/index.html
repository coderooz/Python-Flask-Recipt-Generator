{% extends "base.html" %}
{% block content %}
<h2 class="section-title">New Receipt</h2>
{% if cfg %}
  <div class="org-banner">
    <div>
      <strong>{{ cfg.org_name or cfg.get('org_name') }}</strong><br/>
      {{ cfg.org_address or cfg.get('org_address') }}
    </div>
    <div class="muted">
      {{ cfg.org_phone or cfg.get('org_phone') }}<br/>
      {{ cfg.org_email or cfg.get('org_email') }}
    </div>
  </div>
{% endif %}

<form method="post" action="{{ url_for('create') }}" class="grid">
  <h3 class="subheading">Receipt & Client Details</h3>
  <div class="grid grid-3">
    <div><label>Registration No.</label><input name="registration_no" placeholder="e.g., 01"></div>
    <div><label>Name</label><input name="name" placeholder="Full name" required></div>
    <div><label>Guardian</label><input name="guardian" placeholder="Guardian / Parent / NA"></div>
    <div><label>Gender</label><input name="gender" placeholder="Male / Female / Other"></div>
    <div><label>Age</label><input name="age" type="number" min="0" placeholder="e.g., 23"></div>
    <div><label>Phone</label><input name="phone" placeholder="+91XXXXXXXXXX"></div>
    <div class="col-span-2"><label>Address</label><input name="address" placeholder="Street, City, State"></div>
    <div><label>Consultant</label><input name="consultant" placeholder="Doctor / Staff"></div>
  </div>

  <h3 class="subheading">Line Item</h3>
  <div class="grid grid-3">
    <div class="col-span-2"><label>Particulars</label><input name="item_desc" value="Consultation Fees"></div>
    <div><label>Amount (INR)</label><input name="amount" type="number" step="0.01" value="500"></div>
    <div></div>
    <div></div>
    <div><label>Paid Amount (INR)</label><input name="paid_amount" type="number" step="0.01" value="500"></div>
  </div>

  <div class="actions"><button type="submit">Save & Preview</button></div>
</form>

<hr class="divider"/>

<h2 class="section-title">Recent Receipts</h2>
<table class="table">
  <thead>
    <tr><th>ID</th><th>Name</th><th>Amount</th><th>Date</th><th>Actions</th></tr>
  </thead>
  <tbody>
    {% for r in receipts %}
      <tr>
        <td>#{{ r.id }}</td>
        <td>{{ r.name }}</td>
        <td>â‚¹ {{ "%.2f"|format(r.paid_amount) }}</td>
        <td>{{ r.created_at.strftime("%Y-%m-%d %H:%M") }}</td>
        <td><a href="{{ url_for('preview', rid=r.id) }}">View</a></td>
      </tr>
    {% else %}
      <tr><td colspan="5" class="muted">No receipts yet.</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
